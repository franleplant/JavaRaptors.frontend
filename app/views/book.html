<div class="detailed_view book_view">


		<div class="row">


			<form ng-submit="save()" class="form-horizontal">

				<fieldset class="span4">
					<img class="img-polaroid" ng-src={{book.img}} style="height:300px">
					<a class="btn btn-block" ng-href="#/book/edit/{{book.id}}" ng-if="'detailed_view' | testPathRegExp">Editar Libro</a>
					<button type="submit" class="btn btn-block" ng-if="'edit, create' | testPathRegExp">Guardar Cambios</button>
				</fieldset>



				<fieldset class="span8" ng-if="'detailed_view' | testPathRegExp">

					<h1 class="media-heading">
						{{book.title}}
					</h1>


					<div class="authors clearfix" ng-if="'detailed_view' | testPathRegExp">			
						<a ng-repeat="author in book.authors" ng-href="#/author/detailed_view/{{author.id}}" target="_blank">
							<h3 class="media-heading">{{author.nick}}</h3>
						</a>
					</div>

					<!-- THIS IS NOT BEEING USED, BUT WHEN ERASED IT CHANGES THE PAGE LAYOUT, REMOVE IT WITH MORE TIME TO FIX IT-->
					<div ng-if="'edit, create' | testPathRegExp">
						<h3>Autores <button type="button" class="btn" ng-click="add_author()"><i class="icon-plus-sign"></i></button></h3>
						<span ng-repeat="author in book.authors" ng-model="author.nick" contentEditable="{{'edit, create' | testPathRegExp}}">
							{{author.nick}}
							<button class="btn" ng-click="rm_author($index)"><i class="icon-minus-sign"></i></button>
						</span> 

					</div>
				

					<hr/>	
					
				</fieldset>

				<fieldset class="span8" ng-if="'detailed_view' | testPathRegExp">

					<h3>Resumen</h3>
					<p>{{book.summary}}</p>
					<hr/>
					
				</fieldset>	



				<fieldset class="span8">
					<h3>Datos</h3>
	
	 				<div class="control-group" ng-if="'edit, create' | testPathRegExp">
						<label class="control-label">Titulo*: </label>
						<jr-display-and-edit ng-model="book.title" jr-placeholder="Titulo" required></jr-display-and-edit>
					</div>

	 				<div class="control-group" ng-if="'edit, create' | testPathRegExp">
						<label class="control-label">Resumen: </label>
						<jr-display-and-edit ng-model="book.summary" jr-placeholder="Resumen">
						</jr-display-and-edit>
					</div>

	 				<div class="control-group" >
						<label class="control-label">ISBN*: </label>
						<jr-display-and-edit ng-model="book.isbn" jr-placeholder="ISBN" required></jr-display-and-edit>
					</div>

	 				<div class="control-group" >
						<label class="control-label">Editorial*: </label>
						<jr-display-and-edit ng-model="book.editorial.name" jr-placeholder="Editorial" link="#/editorial/detailed_view/{{book.editorial.id}}" required>
						</jr-display-and-edit>
					</div>

	 				<div class="control-group" >
						<label class="control-label">Edición: </label>
						<jr-display-and-edit ng-model="book.editionNumber" jr-placeholder="Edicion"></jr-display-and-edit>
					</div>

	 				<div class="control-group" >
						<label class="control-label">Idioma: </label>
						<jr-display-and-edit ng-model="book.lang" jr-placeholder="Idioma"></jr-display-and-edit>
					</div>

	 				<div class="control-group" >
						<label class="control-label">Valuacion: </label>
						<jr-display-and-edit ng-model="book.val" jr-placeholder="Valuacion"></jr-display-and-edit>
					</div>

	 				<div class="control-group" >
						<label class="control-label">Precio: </label>
						<jr-display-and-edit ng-model="book.price" jr-placeholder="Precio"></jr-display-and-edit>
					</div>

	 				<div class="control-group" >
						<label class="control-label">Portada: </label>
						<jr-display-and-edit ng-model="book.img" jr-placeholder="Portada(url)"></jr-display-and-edit>
					</div>


				</fieldset>
				
				<p ng-if="'edit, create' | testPathRegExp">Los campos marcados con * son obligatorios</p>


				<fieldset class="span12"><hr/></fieldset>

				<fieldset class="span12" ng-if="'edit, create' | testPathRegExp">

					<h3>
						Autores
						<button type="button" class="btn" ng-click="add_author()" ng-if="'edit, create' | testPathRegExp">
							<i class="icon-plus-sign"></i>
						</button>
					</h3>

			 		<div ng-repeat="author in book.authors" class="control-group" >
			 			<label class="control-label">
			 				<button class="btn" ng-click="rm_author($index)" ng-if="'edit, create' | testPathRegExp"><i class="icon-minus-sign"></i></button>
			 			</label>
						
						<jr-display-and-edit ng-model="author.nick" jr-placeholder="Nuevo Autor"></jr-display-and-edit>
						
					</div>			

					<hr/>
				</fieldset>

				


				<fieldset class="span8">

					<h3>
						Generos 
						<button type="button" class="btn" ng-click="add_genre()" ng-if="'edit, create' | testPathRegExp">
							<i class="icon-plus-sign"></i>
						</button>
					</h3>

			 		<div ng-repeat="genre in book.genres" class="control-group" >
			 			<label class="control-label">
			 				<button class="btn" ng-click="rm_genre($index)" ng-if="'edit, create' | testPathRegExp"><i class="icon-minus-sign"></i></button>
			 			</label>
						
						<jr-display-and-edit ng-model="genre.name" jr-placeholder="Nuevo Genero"></jr-display-and-edit>
						
					</div>			

				</fieldset>




				<fieldset class="span9">
					<div class="span12">
						<hr/>
						<h3> Ejemplares  
							<button type="button" class="btn" ng-click="add_copy()" ng-if="'edit, create' | testPathRegExp">
								<i class="icon-plus-sign"></i>
							</button>
						</h3> 
						<table class="table table-hover">
							<thead>
								<tr>
									<th># Serie</th>

									<th>Disponible</th>
									
									<th>Año de Edicion</th>		
									
									<th>Estado Fisico</th>

									<th>Ubicación</th>

									<th>Comentarios</th>

									<th>Creacion</th>

									<th>Ultima Edicion</th>

									<th>Tipo de Prestamo Posible</th>

									<th ng-if="'detailed_view' | testPathRegExp">Acciones</th>	

									<th ng-if="'edit, create' | testPathRegExp">Borrar Copia</th>							
									
								</tr>
							</thead>
							<tbody>
								<tr ng-repeat="copy in book.copies">
									<td>{{copy.id}}</td>

									<td>
										{{copy.lend.lendType == null | checkmark}}
									</td>
													
									<td contentEditable="{{'edit, create' | testPathRegExp}}" ng-model="copy.editionYear" title="Click to edit">
										{{copy.editionYear}}
									</td>
	

									<td contentEditable="{{'edit, create' | testPathRegExp}}" ng-model="copy.state" title="Click to edit">
										{{copy.state}}
									</td>


									<td>
										<span  contentEditable="{{'edit, create' | testPathRegExp}}" ng-model="copy.location.shelves" title="Click to edit">
											{{copy.location.shelves}}
										</span>, 
										<span  contentEditable="{{'edit, create' | testPathRegExp}}" ng-model="copy.location.shelf" title="Click to edit">
											{{copy.location.shelf}}
										</span>
									</td>	

									<td contentEditable="{{'edit, create' | testPathRegExp}}" ng-model="copy.comments" title="Click to edit">
										{{copy.comments}}
									</td>

									<td>
										{{copy.audit.createDate | date:'dd/MM/yyyy'}} {{copy.audit.createUser}}
									</td>	

									<td>
										{{copy.audit.editDate | date:'dd/MM/yyyy'}} {{copy.audit.editUser}}
									</td>	

									<td>
										<p ng-if="'detailed_view' | testPathRegExp">
											<span>{{copy.lendTypes[0] | translate}}</span>
											<span>, {{copy.lendTypes[1] | translate}}</span>
										</p>
										
										<div ng-if="'edit, create' | testPathRegExp" ng-controller="LendTypeSelectController">
											<span ng-repeat="lt in lendTypes_options">
												<input type="checkbox"  ng-model="copy[lt]" ng-change="change(lt)">
												{{lt}}
												<br/>
											</span>
											
											
											
										</div>
		
									</td>

									<td ng-if="'detailed_view' | testPathRegExp">
										<a ng-if="copy.lend.lendType == null" ng-href="#/copy/lend/{{copy.id}}" target="_blank">
											prestar
										</a>
										<a ng-if="copy.lend.lendType != null" ng-href="#/copy/return/{{copy.id}}" target="_blank">
											devolver
										</a>
										<!--
										<button class="btn" type="button" title="Informacion del Prestamo">+</button>
										-->
									</td>	

									<td ng-if="'edit, create' | testPathRegExp">
										<!--
										<button class="btn" type="button" title="Informacion del Prestamo">+</button>
										-->
										<button class="btn" ng-if="copy.lend.lendType == null" ng-click="rm_copy($index)" title="Borrar Ejemplar">
											<i class="icon-minus-sign"></i>
										</button>
									</td>							
								</tr>
						  </tbody>
						</table>
						<hr/>
					</div>


				</fieldset>

				<jr-audit ng-model="book.audit"></jr-audit>

				<fieldset class="span8" ng-if="'edit' | testPathRegExp">
					<button type="button" class="btn delete_entity" ng-click="confirm()"><i class="icon-remove"></i> Borrar el Libro</button>
				</fieldset>


			</form>

		</div>




   
  

 

</div>